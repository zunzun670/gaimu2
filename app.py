import streamlit as st
import random
st.markdown(""" <style> div[role='radiogroup'] > label { line-height: 1.8; padding-top: 4px; padding-bottom: 4px; } </style> """, unsafe_allow_html=True)

questions = [
   {
              "q":"一般住宅の屋内配線で「VVFケーブル」を使用する目的として最も適切なのはどれ？",
"choices": [ "イ: 高電圧を長距離送電するため", "ロ: 屋内の固定配線に使うため", "ハ: 地中に直接埋設するため", "ニ: 防爆エリアで使用するため" ],
"correct": "ロ",
"info": "VVFケーブルは住宅などの屋内の固定配線に使われるケーブルだね！絶縁体と被覆が一体化していて施工しやすいのが特徴だよ。"
    },   
  { 
       "q": "電線の太さを表す単位はどれ？", 
"choices": [ "イ: mm²", "ロ: kg", "ハ: V", "ニ: A" ], 
"correct": "イ", 
"info": "電線の太さはmm²（平方ミリメートル）で表すよ。太さが大きいほど電流を多く流せるんだ。" 
    } ,   
{ "q": "一般的な住宅用コンセント回路（20A）の電線太さとして正しいのはどれ？", 
"choices": [ "イ: 1.6mm", "ロ: 2.0mm", "ハ: 3.2mm", "ニ: 5.5mm" ], 
 "correct": "ロ", 
 "info": "住宅の20Aコンセント回路は2.0mmのVVFケーブルを使うのが一般的だよ。" 
   },
{ "q": "漏電遮断器（ELB）の主な役割はどれ？", 
"choices": [ "イ: 過電流を防止する", "ロ: 雷サージを防止する", "ハ: 漏電を検出して回路を遮断する", "ニ: 電圧を安定させる" ], 
 "correct": "ハ", 
 "info": "漏電遮断器は漏電を検出して回路を遮断し、感電や火災を防ぐための装置だよ。" 
   },
{ "q": "三路スイッチを使う目的として正しいのはどれ？", 
 "choices": [ "イ: 2つの場所から1つの照明を操作するため", "ロ: 3つの照明を同時に点灯させるため", "ハ: 3相電源を切り替えるため", "ニ: 非常用照明を制御するため" ], 
 "correct": "イ", 
 "info": "三路スイッチは階段や廊下など、2か所から1つの照明を操作したいときに使うよ。" 
    },
   { "q": "この図記号が示す機器はどれ？", 
    "img": "images1.jpg", 
    "choices": [ "イ: 配線用遮断器（ブレーカ）", "ロ: 漏電遮断器", "ハ: 変圧器", "ニ: 電力量計" ], 
"correct": "イ", 
"info": "この図記号は配線用遮断器（ブレーカ）だよ。過電流を防ぐために使われる保護装置だね。" 
   },
    {"q": "図のような回路で、端子a-b間の合成抵抗[Ω]は。",
        "img": "images2.jpg", 
        "choices": ["イ. 1", "ロ. 2", "ハ. 3", "ニ. 4"],
        "correct": "ロ",
        "info": "左右が対称だから中央の3Ωには電流が流れず、回路は左右の枝だけで考えられるように簡略化できるよ！その結果、全体の合成抵抗は2Ωになるね。", 
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
    {
        "q": "抵抗Ｒ[Ω]に電圧Ｖ[V]を加えると電流Ｉ[A]が流れ、Ｐ[W]の電力が消費される。抵抗Ｒを示す式として誤っているものは",
        "choices": ["イ. PI/V", "ロ. P/I²", "ハ. V²/P", "ニ. V/I"],
        "correct": "イ",
        "info": "電力Pは V×I だから、抵抗Rは V/I、V²/P、P/I² のいずれかで表せるよ。P/I は電圧になってしまうため誤りだね。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
    {
        "q": "電熱器により60kgの水の温度を20K上昇させるのに必要な電力量[kW·h]は。ただし、水の比熱4.2kJ/(kg·K)とし、熱効率は100%とする。",
        "choices": ["イ. 1.0", "ロ. 1.2", "ハ. 1.4", "ニ. 1.6"],
        "correct": "ハ",
        "info": "水を20 K上昇させるのに必要な熱量は60×4.2×20=5040 kJ となり、これは 1.4kW･h に相当するよ。熱効率100％なので、この値がそのまま必要な電力量になるんだ。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
    {
        "q": "図のような三相負荷に三相交流電圧を加えたとき、各線に20Aの電流が流れた。線間電圧E[V]は。",
        "img": "images3.jpg", 
        "choices": ["イ. 120", "ロ. 173", "ハ. 208", "ニ. 240"],
        "correct": "ハ",
        "info": "デルタ結線では、線電流と抵抗に流れる電流（相電流）が同じになるから、まず抵抗1つに流れる電流は20Aと考えて大丈夫だよ。その抵抗の電圧は𝑉=𝐼×𝑅=20×6=120V。デルタ結線では、線間電圧はこの相電圧の3倍になるという決まりがあるから、120×3≈208Vとなる。\n\n「デルタは線間＝相電圧×√3」が大切！",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
    {
        "q": "図の三相3線式回路で×印の箇所で断線した場合、負荷の全消費電力[kW]は。ただし、負荷の抵抗は30Ωとし、配線の抵抗は無視し、電源電圧は一定とする。",
        "img": "images4.jpg", 
        "choices": ["イ. 0.7", "ロ. 0.9", "ハ. 1.3", "ニ. 2.0"],
        "correct": "ニ",
        "info": "デルタ結線で1本の線が切れると、三角形のうち2つの抵抗だけが電源につながった状態になる。この2つの抵抗には、それぞれ200Vがそのまま加わるから1つあたりの電力は200²÷30≈1.33kWになるね。残った2つの抵抗はどちらも同じように電力を消費するよ。だから全体の消費電力は1.33×2≈2.0kWとなるんだ。\n\n「デルタ結線で1線断線 → 2つだけ動く」という流れを覚えておいてね。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
    {
        "q": "低圧屋内配線の合成樹脂管工事で、管内に直径2.0mmの600Vビニル絶縁電線（軟銅線）を4本収めて施設した場合、電線1本当たりの許容電流[A]は。ただし、周囲温度は30℃以下とする。",
        "choices": ["イ. 17", "ロ. 19", "ハ. 22", "ニ. 24"],
        "correct": "ハ",
        "info": "直径2.0 mm のビニル絶縁電線は、本来「31A」が1本あたりの基準となる許容電流だよ。でも、同じ管の中に4本以上の電線を入れると、熱がこもりやすくなるため「0.7」の低減係数を掛ける決まりになっている。つまり、31𝐴×0.7=21.7𝐴となり、実際に使える許容電流はこれより小さくなる。\n\n係数0.7と基準31Aの組み合わせを覚えておくと安心だよ。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
    {
        "q": "金属線ぴ工事に使用する金属製線ぴに関する記述として，正しいものは。",
        "choices": ["イ.壁等に固定して絶縁電線(屋外用ビニル絶縁電線を除く。)を収める。", 
                    "ロ.コンクリート床内に埋め込んで絶縁電線を収める。", 
                    "ハ.本体と導体とが一体となった材料で，照明器具等を直接取り付けて使用する。", 
                    "ニ.天井等につるし，ケーブルを並べて支持するのに用いる。"],
        "correct": "イ",
        "info": "金属製線ぴは、壁や柱などにしっかり固定して、その中に絶縁電線（ただし屋外用ビニル絶縁電線は除く）を収めて使う工事方式だよ。電線を保護しつつ見た目も整えるための設備なんだ。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
{
        "q": "600Vポリエチレン絶縁耐燃性ポリエチレンシースケーブル平形の絶縁物の最高許容温度［℃］は。",
        "choices": ["イ.60", "ロ.75", "ハ.90", "ニ.120"],
        "correct": "ロ",
        "info": "600Vポリエチレン絶縁耐燃性ポリエチレンシースケーブル平形は、規格上「75℃」が絶縁体の最高許容温度として定められているよ。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
{
        "q": "ねじなし電線管の曲げ加工に使用する工具は。",
        "choices": ["イ.トーチランプ", "ロ.ディスクグラインダ", "ハ.パイプレンチ", "ニ.パイプベンダ"],
        "correct": "ニ",
        "info": "ねじなし電線管（E管）の曲げ加工には、専用のパイプベンダを使うのが基本だよ。ねじなし電線管は薄くて軽い金属管だから、パイプベンダで足を使って滑らかに曲げられるように作られているんだ。\n\n「E管＝パイプベンダ」と覚えよう。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
{
        "q": "必要に応じ，スターデルタ始動を行う電動機は。",
        "choices": ["イ.一般用三相かご形誘導電動機", "ロ.三相巻線形誘導電動機", "ハ.直流分巻電動機", "ニ.単相誘導電動機"],
        "correct": "イ",
        "info": "スターデルタ始動は、三相かご形誘導電動機の始動電流を小さくするための方法だよ。最初は「スター結線」で電圧を下げて静かに回し、回転が安定したら「デルタ結線」に切り替えて通常運転に入る仕組みになっている。\n\n「スターデルタ＝三相かご形」と覚えよう。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
     {
        "q": "系統連系型の小出力太陽光発電設備において，使用される機器は。",
        "choices": ["イ.調光器", "ロ.低圧進相コンデンサ", "ハ.自動点滅器", "ニ.パワーコンディショナ"],
        "correct": "ニ",
        "info": "太陽光発電は直流で電気をつくるけれど、家庭や電力会社の系統は交流で動いているため、そのままでは接続できないんだ。そこで直流を交流に変換し、電圧や周波数を整えて系統に安全に流せるようにする役目を持つのがパワーコンディショナだよ。\n\n「太陽光＝パワコン」と覚えておくといいよ。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },
   {
        "q": "写真に示す材料の名称は。",
        "img": "images5.jpg", 
        "choices": ["イ.ユニバーサル", "ロ. ノーマルベンド", "ハ. ベンダ", "ニ. カップリング"],
        "correct": "ロ",
        "info": "ノーマルベンドは、金属電線管を現場で曲げずに済むよう、あらかじめ90度に加工された既製品の曲がり管だよ。電線を通す配管ルートで方向を変えるときに使われ、見た目は滑らかなL字形になっているのが特徴なんだ。",
        "source": "出典：令和7年度下期 第二種電気工事士試験（学科）"
    },

   
]

# --- 最初の1回だけシャッフル ---
if "questions" not in st.session_state:
    st.session_state.questions = questions.copy()
    random.shuffle(st.session_state.questions)

# --- index 初期化 ---
if "index" not in st.session_state:
    st.session_state.index = 0

current = st.session_state.questions[st.session_state.index]

st.write("### 問題")
st.write(current["q"])
if "source" in current:
    st.caption(current["source"])
if "img" in current:
    st.image(current["img"])

# --- 回答済みフラグ ---
if "answered" not in st.session_state:
    st.session_state.answered = False

selected = st.radio("選択肢を選んでね", current["choices"], index=None)

# --- 回答ボタン ---
if st.button("回答する") and not st.session_state.answered:
    if selected is None:
        st.warning("選択肢を選んでね！")
    else:
        st.session_state.selected = selected
        st.session_state.answered = True
        st.rerun()

# --- 回答後の表示 ---
if st.session_state.answered:

    # 正解判定
    if st.session_state.selected.startswith(current["correct"]):
        st.success("正解！😊🎉")
    else:
        st.error("ざんねん😭")

    # 正解・不正解どちらでも解説を表示
    if "info" in current:
        st.markdown(current["info"])

    # 次へボタン
    if st.button("次へ"):
        st.session_state.index += 1
        st.session_state.answered = False
        st.rerun()
